
global Dmin C  nr bdat ldat k1 k2 k3 Ip Sbase Vbase Zbase Ibase neval
%% System Data
Sbase=150;%MVA
Vbase=150;%kV
Vbaselow=10;%kV
Zbase=Vbase^2/Sbase;%ohms
Zbaselow=Vbaselow^2/Sbase;%ohms
Ibase=Sbase/(sqrt(3)*Vbase);%kA
econv=0.0001;
itermax=100;
% Generator rated powers and reactances    
SG1=150;%MVA
SG2=150;%MVA
XG1=.15;% pu
XG2=.15;% pu
Xt=0.04;%pu
Xg1=(XG1*Vbaselow^2/SG1)/Zbase+Xt;
Xg2=(XG2*Vbaselow^2/SG2)/Zbase+Xt;
Rg1=0;
Rg2=0;
Le=[100 70 80 100 110 90 100]; 
R=[.004 .0057 .005 .005 .0045 .0044 .005].*Le/Zbase; %line resistances (ohms)
X=[ .05 .0714 .0563 .045 .0409 .05 .05].*Le/Zbase; %line reactance (ohms)
B=[0     0    0 0     0    0 0 0]*Zbase; %line total susceptance (siemens)
nl=length(R);
%		1 2	3	  4	    5	  6	  7   8	9       10    11		12   13  14
ldat=[  
        1 3 10001 Rg1  Xg1    0   0   0;
        2 7 10002 Rg2  Xg2    0   0   0;
        3 8 90001 R(1) X(1) B(1)  0   0;
        3 4 90002 R(2) X(2) B(2)  0   0;
        4 5 90003 R(3) X(3) B(3)  0   0;
        5 6 90004 R(4) X(4) B(4)  0   0;        
        6 7 90005 R(5) X(5) B(5)  0   0;
        7 8 90005 R(6) X(6) B(6)  0   0; 
        3 7 90006 R(7) X(7) B(7)  0   0;
];
%     1   2     3 4    5 6      7       8   9    10  11 12  13   14  15    16   17   18 19    20 21 22 23  
bdat=[  1 1001  1 0    0 0.0000 0.0000  1   0    0   0  0   0     0  0    1.0  1.0   0  0      0 0  0 0;
        2 1001  2 1.00 0 0.0000 0.0000  1   0    0   0  0   0     0  0     .9  1.10  0  0      0 0  0 0;
        3 9001  3 0    0 0.0000 0.0000  1   0    0   0  0   0     0  0     .9  1.10  0  0      0 0  0 0;
        4 9002  3 0    0 60/150 40/150  1   0    0   0  0   0     0  0     .9  1.10  0  0      0 0  0 0;
        5 9003  3 0    0 70/150 40/150  1   0    0   0  0   0     0  0     .9  1.10  0  0      0 0  0 0;
        6 9001  3 0    0 70/150 50/150  1   0    0   0  0   0     0  0     .9  1.10  0  0      0 0  0 0;
        7 9002  3 0    0 0.0000 0.0000  1   0    0   0  0   0     0  0     .9  1.10  0  0      0 0  0 0;
        8 9003  3 0    0 40/150 20/150  1   0    0   0  0   0     0  0     .9  1.10  0  0      0 0  0 0;
                 ];
             
             z=[1.019500051646;
1.002288444568;
0.991302700490;
0.998757458210;
0.988435063780;
0.929123391975;
0.981765358988;
0.972197778822;
-0.009216593914;
0.010709907398;
-0.028947218420;
-0.052644832872;
-0.086584740877;
-0.056772141659;
-0.013357397135;
-0.041169345993;
3.677274410856;
1.029643796203;
-0.342744629448;
-0.495499665010;
-0.436107144932;
-0.234819083805;
-0.431121225128;
-0.578235543517;
0.335238767;
0.329549683;
0.38736933;
0.20937455];
